<html>
<!-- Distributed under the BSD 2-Clause License. See end of file. -->
<head>
  <!--<link rel='stylesheet' type='text/css' href='css/style.css'>-->
  <script src='js/jquery.js'></script>
  <script src='js/starlings.js'></script>
  <title>Starling Simulator</title>
  <meta name='viewport' content='width=720'/>
  <script>
var canvas;

function err(x) {
  if (x) {
    $('#err').text(x);
  } else {
    $('#err').html('&nbsp;');
  }
}

function log(x) {
  console.log(x);
}

function timeit(thunk) {
  var d = new Date();
  var t = d.getTime();
  thunk();
  d = new Date();
  return d.getTime() - t;
}

function init() {
  canvas = $('#canvas')[0];
  starlings.init(canvas);
  reset();
}

var maxBirdCount = 1000;
var minBirdCount = 10;
var minLeaderCount = 1;

function reset() {
  err('');
  birdCount = parseInt($('#birdCount').val());
  if (isNaN(birdCount) || birdCount > maxBirdCount || birdCount < minBirdCount) {
    err('Bird Count must be between ' + minBirdCount + ' and ' + maxBirdCount);
    return;
  }
  leaderCount = $('#leaderCount').val();
  if (isNaN(leaderCount) ||
      leaderCount > birdCount || leaderCount < minLeaderCount) {
    err('Leader Count must be between ' + minLeaderCount + ' and ' + birdCount);
    return;
  }
  starlings.reset(birdCount, leaderCount);
  starlings.draw();
}

function resetKey(event) {
  if (event.which == '\r'.charCodeAt(0)) {
    event.preventDefault();
    reset();
  }
}
  </script>
</head>
<body onload='init();'>
  <center>
    <h2>A Murmuration of Starlings</h2>
    <table>
      <tr>
        <td>
          <center>
            <canvas id='canvas' style='border: 1px solid;' width='600' height='600'>
            </canvas>
          </center>
        </td>
      </tr>
    </table>
  <table>
    <tr>
      <td colspan='2'>
        <span id='err' style='color: red;'>&nbsp;</span>
      </td>
    </tr>
    <tr>
      <th style='text-align: center;'>Bird count:</th>
      <td><input id='birdCount' type='text' value='100'
                 onKeyDown='resetKey(event)'/>
    </tr>
    <tr>
      <th style='text-align: center;'>Leader count:</th>
      <td><input id='leaderCount' type='text' value='1'
                 onKeyDown='resetKey(event)'/>
    </tr>
    <tr>
      <td></td>
      <td><input type='submit' onClick='reset();' value='Reset'/></td>
    </tr>
  </table>
  </p>
  <p style='font-size: 80%;'>
    Copyright &copy; 2014 Bill St. Clair, All rights reserved<br/>
    Distrbuted under the <a href='LICENSE'>BSD 2-Clause License</a>
  </p>
  </center>
<body>
<!--------------------------------------------------------------------
  --
  -- Copyright (c) 2014, Bill St. Clair <bill@billstclair.com>
  -- All rights reserved.
  -- Distributed under the BSD 2-Clause License
  -- 
  -- Redistribution and use in source and binary forms, with or without
  -- modification, are permitted provided that the following conditions are
  -- met:
  -- 
  -- 1. Redistributions of source code must retain the above copyright
  -- notice, this list of conditions and the following disclaimer.
  -- 
  -- 2. Redistributions in binary form must reproduce the above copyright
  -- notice, this list of conditions and the following disclaimer in the
  -- documentation and/or other materials provided with the distribution.
  -- 
  -- THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
  -- "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
  -- LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
  -- A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
  -- HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
  -- SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
  -- LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
  -- DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
  -- THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
  -- (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
  -- OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
  --
  --------------------------------------------------------------------->
</html>
